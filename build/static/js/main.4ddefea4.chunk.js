(this["webpackJsonpcrime-maps"]=this["webpackJsonpcrime-maps"]||[]).push([[0],{100:function(e,t,a){e.exports=a(129)},128:function(e,t,a){},129:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),c=a.n(o),i=a(63),l=a(26),s=a(17),u=a(177),m=a(40),d=a(159),g=a(174),p=a(175),f=a(176),b=a(179),E=a(29),O=a(178),C=a(81),h=a.n(C),v=a(21),y=a(153),N=a(82),j=a.n(N),k=a(83),x=a.n(k),I={novosibirsk:{backgroundImage:"url(".concat(j.a,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"},krasnoyarsk:{backgroundImage:"url(".concat(x.a,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"}},S=Object(y.a)((function(e){return Object(v.a)({},I,{root:{width:360,flexShrink:0},rootPaper:{width:360},header:{position:"relative",height:200},searchContainer:{display:"flex",justifyContent:"space-between",margin:e.spacing(3),padding:"5px 10px",backgroundColor:"#fff",borderRadius:2*e.shape.borderRadius,border:"1px solid #ccc"},search:{width:"86%"},darkBG:{paddingTop:1,height:"100%",backgroundColor:"rgba(0, 0, 0, .5)"}})})),z=a(56),w=a.n(z),T=a(50),M=a(156),R=a(158),Z=a(44),L=Object(y.a)((function(e){return Object(Z.a)({root:{display:"flex",alignItems:"center",overflowX:"hidden",margin:e.spacing(1)},cityName:{marginLeft:e.spacing(1),color:e.palette.text},emblemContainer:{display:"none"},grow:{flexGrow:1},changeCityButton:{color:e.palette.text}},e.breakpoints.up("md"),{root:{margin:e.spacing(3)},cityName:{color:"#fff"},emblemContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:40,height:40,background:"#fff",borderRadius:"50%"},emblem:{height:30},changeCityButton:{color:"#fff"}})})),_=a(87),B=a.n(_),A=a(88),D=a.n(A),G={novosibirsk:B.a,krasnoyarsk:D.a};var H=function(e){var t=e.fetchCities,a=e.setModal,o=e.loading,c=e.city,i=e.titleCity,l=L();return Object(n.useEffect)((function(){o&&t()}),[o,t]),r.a.createElement("div",{className:l.root},r.a.createElement("div",{className:l.emblemContainer},r.a.createElement("img",{className:l.emblem,src:G[i],alt:""})),r.a.createElement(T.a,{variant:"h6",className:l.cityName},c),r.a.createElement("div",{className:l.grow}),r.a.createElement(M.a,{onClick:function(){return a(!0)}},r.a.createElement(R.a,{className:l.changeCityButton})))};var J=function(e){var t=e.selectedCity,a=e.loading,n=e.fetchCities,o=e.setModal,c=S();return r.a.createElement(b.a,{smDown:!0,implementation:"css"},r.a.createElement(E.a,{variant:"permanent",className:c.root,classes:{paper:c.rootPaper}},r.a.createElement("div",{className:h()(c.header,c[t.title])},r.a.createElement("div",{className:c.darkBG},r.a.createElement("div",{className:c.searchContainer},r.a.createElement("img",{src:w.a,alt:"",height:"35px"}),r.a.createElement(O.a,{className:c.search,placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e Crime Maps..."})),r.a.createElement(H,{loading:a,fetchCities:n,setModal:o,titleCity:t.title,city:t.name})))))},P=a(59),F=a(183),U=a(160),W=a(161),Y=Object(y.a)((function(e){return{openButton:{position:"absolute",top:e.spacing(1),left:e.spacing(1),zIndex:1e3},root:{width:"80%",zIndex:1001},header:{display:"flex",alignItems:"center",padding:e.spacing(2),paddingRight:e.spacing(0),background:"linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)"},title:{marginLeft:e.spacing(1),color:"#fff"},logo:{height:30},grow:{flexGrow:1},closeMenuButton:{color:"#fff"}}}));var X=function(e){var t=e.loading,a=e.fetchCities,o=e.setModal,c=e.selectedCity,i=Y(),l=Object(n.useState)(!1),s=Object(P.a)(l,2),u=s[0],m=s[1],g=function(e){return m(e)};return r.a.createElement(b.a,{mdUp:!0,implementation:"css"},r.a.createElement(d.a,{className:i.openButton,onClick:function(){return g(!0)}},r.a.createElement(U.a,null)),r.a.createElement(F.a,{open:u,onOpen:function(){return g(!0)},onClose:function(){return g(!1)},className:i.root,classes:{paper:i.root}},r.a.createElement("div",{className:i.header},r.a.createElement("img",{src:w.a,alt:"",className:i.logo}),r.a.createElement(T.a,{variant:"h6",className:i.title},"Crime Maps"),r.a.createElement("div",{className:i.grow}),r.a.createElement(M.a,{className:i.closeMenuButton,onClick:function(){return g(!1)}},r.a.createElement(W.a,null))),r.a.createElement(H,{loading:t,fetchCities:a,setModal:o,titleCity:c.title,city:c.name})))},$=function(){return{type:"FETCH_CITIES"}},q=function(e){return{type:"MODAL",isOpen:e}},K=function(e){return{type:"ERROR",error:e}},Q=function(e){return{type:"CHANGE_CITY",id:e}};var V=Object(l.c)((function(e){var t=e.cities;return{selectedCityId:t.selectedCity,citiesList:t.data,loading:t.loading}}),(function(e){return Object(s.b)({fetchCities:$,setModal:q},e)}))((function(e){var t=e.fetchCities,a=e.setModal,n=e.selectedCityId,o=e.citiesList,c=e.loading,i=o.find((function(e){return e.id===n}));return r.a.createElement("nav",null,r.a.createElement(J,{selectedCity:i,loading:c,fetchCities:t,setModal:a}),r.a.createElement(X,{selectedCity:i,loading:c,fetchCities:t,setModal:a}))})),ee=a(20),te=a.n(ee),ae=a(180),ne=a(182),re=a(162),oe=function(e,t){return{type:"CHANGE_COORDINATES",lat:e,lng:t}},ce=function(e){return{type:"SET_ZOOM",zoom:e}},ie=function(){return{type:"INCREMENT_ZOOM"}},le=function(){return{type:"DECREMENT_ZOOM"}},se=a(65),ue=a.n(se);var me=Object(l.c)((function(e){var t=e.map,a=e.geodata;return{lat:t.lat,lng:t.lng,zoom:t.zoom,geodata:a.geodata}}),(function(e){return Object(s.b)({changeCoordinates:oe,changeZoom:ce},e)}))((function(e){var t=e.lat,a=e.lng,n=e.zoom,o=e.geodata,c=e.changeCoordinates,i=e.changeZoom,l=new te.a.Icon({iconUrl:ue.a,iconRetinaUrl:ue.a,iconSize:new te.a.Point(40,75)});return r.a.createElement(ae.a,{center:[t,a],zoom:n,maxZoom:17,minZoom:5,attributionControl:!0,zoomControl:!1,doubleClickZoom:!0,scrollWheelZoom:!0,dragging:!0,animate:!0,easeLinearity:.35,onDragEnd:function(e){var t=e.target.getCenter(),a=t.lat,n=t.lng;c(a,n)},onZoomEnd:function(e){return i(e.target.getZoom())}},r.a.createElement(ne.a,{url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),o?r.a.createElement(re.a,{position:[o.coords.latitude,o.coords.longitude],icon:l}):null)})),de=a(163),ge=a(164),pe=a(166),fe=a(168),be=a(181),Ee=a(169),Oe=a(170),Ce=a(172),he=a(173),ve=a(165),ye=a(167),Ne=a(171),je=Object(y.a)((function(e){return{title:{position:"relative",backgroundColor:"#eee",borderBottom:"1px solid #cecece"},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1)},loadingText:{display:"flex",justifyContent:"center",alignItems:"center"},rotate:{animation:"$rotate 1s infinite"},"@keyframes rotate":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(-360deg)"}},actions:{backgroundColor:"#eee",borderTop:"1px solid #cecece"}}}));var ke=Object(l.c)((function(e){var t=e.cities;return{isOpen:t.isSelectorOpen,cities:t.data,loading:t.loading,error:t.error}}),(function(e){return Object(s.b)({setModal:q,changeCity:Q,changeCoordinates:oe},e)}))((function(e){var t=Object(n.useState)(null),a=Object(P.a)(t,2),o=a[0],c=a[1],i=je(),s=e.isOpen,u=e.loading,m=e.setModal,d=e.cities,g=e.changeCity,p=e.changeCoordinates;return r.a.createElement(de.a,{open:s,onClose:function(){return m(!1)},maxWidth:"sm",fullWidth:!0},r.a.createElement(ge.a,{className:i.title},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0440\u043e\u0434",r.a.createElement(M.a,{onClick:function(){return m(!1)},className:i.closeButton},r.a.createElement(ve.a,null))),r.a.createElement(pe.a,null,u&&r.a.createElement(T.a,{variant:"h6",color:"textSecondary",className:i.loadingText},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u0433\u043e\u0440\u043e\u0434\u043e\u0432",r.a.createElement(ye.a,{className:i.rotate})),!u&&r.a.createElement(fe.a,{component:"nav"},d.map((function(e){return r.a.createElement(be.a,{button:!0,key:e.id,selected:e.id===o,onClick:function(){return c(e.id)}},r.a.createElement(Ee.a,null,e.name),e.id===o&&r.a.createElement(Oe.a,null,r.a.createElement(M.a,null,r.a.createElement(Ne.a,null))))})))),r.a.createElement(Ce.a,{className:i.actions},r.a.createElement(he.a,{onClick:function(){return function(e){var t=d.find((function(t){return t.id===e}));localStorage.setItem("selectedCity",e),Object(l.b)((function(){g(e),m(!1),p(t.lat,t.lng)}))}(o)},disabled:null===o},"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c")))})),xe=Object(y.a)((function(e){return Object(Z.a)({root:{display:"flex",height:"100%"},buttonUserPosition:{position:"absolute",bottom:e.spacing(3),right:e.spacing(3),zIndex:1e3},zoomButtonsContainer:{display:"flex",flexDirection:"column",position:"absolute",top:e.spacing(1),right:e.spacing(1),zIndex:1e3},buttonZoomOut:{marginTop:e.spacing(1)}},e.breakpoints.up("md"),{zoomButtonsContainer:{top:e.spacing(3),right:e.spacing(3)},buttonZoomOut:{marginTop:e.spacing(1)}})}));var Ie=Object(l.c)((function(e){var t=e.geodata,a=e.map;return{geodata:t.geodata,zoom:a.zoom}}),(function(e){return Object(s.b)({changeCoordinates:oe,incrementZoom:ie,decrementZoom:le},e)}))((function(e){var t=e.changeCoordinates,a=e.geodata,n=e.incrementZoom,o=e.decrementZoom,c=e.zoom,i=xe();return r.a.createElement("div",{className:i.root},r.a.createElement(V,null),r.a.createElement(me,null),r.a.createElement(ke,null),r.a.createElement(d.a,{color:"primary",size:"large",className:i.buttonUserPosition,onClick:function(){return t(a.coords.latitude,a.coords.longitude)},disabled:null===a},r.a.createElement(g.a,null)),r.a.createElement("div",{className:i.zoomButtonsContainer},r.a.createElement(d.a,{size:"large",onClick:function(){17!==c&&n()}},r.a.createElement(p.a,null)),r.a.createElement(d.a,{size:"large",className:i.buttonZoomOut,onClick:function(){5!==c&&o()}},r.a.createElement(f.a,null))))})),Se=function(e){return{type:"SET_LOCATION",data:e}},ze=function(e){return{type:"SET_LOCATION_ERROR",error:e}};var we=Object(l.c)(null,(function(e){return Object(s.b)({setLocation:Se,setLocationError:ze},e)}))((function(e){var t=e.setLocation,a=e.setLocationError;return navigator.geolocation.getCurrentPosition(t,a),r.a.createElement(n.Fragment,null,r.a.createElement(u.a,null),r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/",component:Ie})))})),Te=a(91),Me={data:JSON.parse(localStorage.getItem("citiesList"))||[{_id:"5e8f0f4f8883b725cc275bad",id:1,title:"novosibirsk",name:"\u041d\u043e\u0432\u043e\u0441\u0438\u0431\u0438\u0440\u0441\u043a",lat:55.0415,lng:82.9346}],isSelectorOpen:!1,error:!1,loading:!0,selectedCity:+localStorage.getItem("selectedCity")||1};var Re,Ze,Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD":return Object(v.a)({},e,{data:t.cities});case"MODAL":return Object(v.a)({},e,{isSelectorOpen:t.isOpen});case"ERROR":return Object(v.a)({},e,{error:t.error});case"LOADING":return Object(v.a)({},e,{loading:t.loading});case"CHANGE_CITY":return Object(v.a)({},e,{selectedCity:t.id});default:return e}},_e=+JSON.parse(localStorage.getItem("selectedCity")),Be=JSON.parse(localStorage.getItem("citiesList"));if(_e&&Be){var Ae=Be.find((function(e){return e.id===_e}));Re=Ae.lat,Ze=Ae.lng}else Re=55.0415,Ze=82.9346;var De={lat:Re,lng:Ze,zoom:13},Ge={geodata:null,error:!1},He=Object(s.c)({cities:Le,map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_COORDINATES":return Object(v.a)({},e,{lat:t.lat,lng:t.lng});case"SET_ZOOM":return Object(v.a)({},e,{zoom:t.zoom});case"INCREMENT_ZOOM":return Object(v.a)({},e,{zoom:++e.zoom});case"DECREMENT_ZOOM":return Object(v.a)({},e,{zoom:--e.zoom});default:return e}},geodata:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOCATION":return Object(v.a)({},e,{geodata:t.data});case"SET_LOCATION_ERROR":return Object(v.a)({},e,{error:!0});default:return e}}}),Je=a(41),Pe=a.n(Je),Fe=a(37),Ue=a(90),We=a.n(Ue),Ye=Pe.a.mark($e),Xe=Pe.a.mark(qe);function $e(){var e,t;return Pe.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Fe.b)(We.a.get,"/api/cities/");case 3:return e=a.sent,t=e.data,localStorage.setItem("citiesList",JSON.stringify(t)),a.next=8,Object(Fe.c)({type:"ADD",cities:t});case 8:return a.next=10,Object(Fe.c)(K(!1));case 10:return a.next=12,Object(Fe.c)({type:"LOADING",loading:!1});case 12:a.next=19;break;case 14:return a.prev=14,a.t0=a.catch(0),console.error(a.t0.message),a.next=19,Object(Fe.c)(K(!0));case 19:case"end":return a.stop()}}),Ye,null,[[0,14]])}function qe(){return Pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Fe.d)("FETCH_CITIES",$e);case 2:case"end":return e.stop()}}),Xe)}var Ke=Pe.a.mark(Qe);function Qe(){return Pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Fe.a)([qe()]);case 2:case"end":return e.stop()}}),Ke)}var Ve=Qe,et=Object(Te.a)(),tt=Object(s.e)(He,Object(s.a)(et));window.getState=tt.getState,et.run(Ve);var at=tt;a(128);c.a.render(r.a.createElement(i.a,null,r.a.createElement(l.a,{store:at},r.a.createElement(we,null))),document.getElementById("root"))},56:function(e,t,a){e.exports=a.p+"static/media/logo_dark.6ea33164.svg"},65:function(e,t,a){e.exports=a.p+"static/media/user-pin.ed058a81.svg"},82:function(e,t,a){e.exports=a.p+"static/media/novosibirsk.3223fede.jpg"},83:function(e,t,a){e.exports=a.p+"static/media/krasnoyarsk.aaf9cd5c.jpg"},87:function(e,t,a){e.exports=a.p+"static/media/novosibirsk.f2328259.svg"},88:function(e,t,a){e.exports=a.p+"static/media/krasnoyarsk.0bba5569.svg"}},[[100,1,2]]]);
//# sourceMappingURL=main.4ddefea4.chunk.js.map